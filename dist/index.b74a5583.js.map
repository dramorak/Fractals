{"mappings":"AAgHA,IAAIA,SAAWC,OAAOC,WAAW,sCAAsCC,QAEvE,SAASC,iBACP,IAAIC,EAAW,CACbC,KAAMC,KACNC,OAAQC,OACRC,SAAUC,SACVC,UAAWC,UACXC,QAASC,QACTC,QAASC,QACTC,SAAUC,SACVC,SAAUC,SACVC,OAAQC,OACRC,KAAM,QAEJC,EAAY,CACdC,IAAK,EACLC,IAAK,EACLC,MAAO,EACPC,KAAM,EACNC,KAAM,EACNC,IAAK,EACLC,MAAO,EACPC,MAAO,EACPC,KAAM,EACNC,IAAK,IAEHC,EAAO,CACTC,OAAQC,SAASC,cAAc,WAC/BC,MAAO,mBAELC,GAA4B,EAChC,IAAIC,EAAOJ,SAASC,cAAc,SAC9BI,EAAOL,SAASC,cAAc,QAC9BK,EAAqBN,SAASC,cAAc,uBAGhD,SAASM,EAAQC,GAEf,IAAIT,EAASS,EAAET,OAEXI,IACFH,SAASC,cAAc,uBAAuBQ,MAAMC,QAAU,OAC9DV,SACGC,cAAc,qBACdU,aAAa,QAAS,sBACzBR,GAA4B,GAG9B,IAAIS,EAAab,EAAOc,aAAa,SAErC,GAAmB,cAAfD,EAA4B,CAI9B,GAHAb,EAASA,EAAOe,WAGE,SAAdf,EAAOgB,GAET,YADAC,aAAaC,KAAKC,IAEb,GAAkB,SAAdnB,EAAOgB,GAEhB,YADAC,aAAaC,KAAKE,IAEb,GAAkB,WAAdpB,EAAOgB,GAEhB,YADAK,mBAEK,GAAkB,qBAAdrB,EAAOgB,GAA2B,CAY3C,OAXAf,SACGC,cAAc,qBACdU,aAAa,QAAS,+BAGAX,SAASC,cAAc,uBAC7BQ,MAAMC,QAAU,aAGnCP,GAA4B,GAGvB,GAAqC,oBAAjCJ,EAAOc,aAAa,SAG7B,YADAQ,KAAKC,UAAYnC,EAAUY,EAAOgB,KAE7B,GAAkB,WAAdhB,EAAOgB,GAChBM,KAAKE,UAAY,SAEjBvB,SACGC,cAAc,WACdU,aAAa,QAAS,qBACzBX,SAASC,cAAc,SAASU,aAAa,QAAS,iBACjD,GAAkB,SAAdZ,EAAOgB,GAChBM,KAAKE,UAAY,OAEjBvB,SAASC,cAAc,WAAWU,aAAa,QAAS,YACxDX,SACGC,cAAc,SACdU,aAAa,QAAS,0BACpB,GAAkB,SAAdZ,EAAOgB,GAChBS,YACK,GAAkB,QAAdzB,EAAOgB,GAAc,CAEtBU,QAAQ,+CAEdD,OAEFE,YAAW,IAAM/D,OAAOgE,SAASC,QAAQjE,OAAOgE,SAASE,OAAO,SAE3D,CAELR,KAAKZ,MAAQ1C,EAASgC,EAAOgB,IAG7B,IAAIe,EAAI/B,EAAOc,aAAa,SAC5Bd,EAAOY,aAAa,QAASmB,EAAI,kBAGbC,IAAhBjC,EAAKC,QACPD,EAAKC,OAASA,EACdD,EAAKI,MAAQ4B,IAEbhC,EAAKC,OAAOY,aAAa,QAASb,EAAKI,OACnCJ,EAAKC,SAAWA,GAClBD,EAAKC,YAASgC,EACdjC,EAAKI,WAAQ6B,EACbV,KAAKZ,MAAQxC,OAEb6B,EAAKC,OAASA,EACdD,EAAKI,MAAQ4B,SAId,CAAA,GAAmB,qBAAflB,EAgDT,OAhD4C,CAC5C,IAAIoB,EAAIjC,EAAOe,WAGf,GAAa,oBAATkB,EAAEjB,GAEJM,KAAKY,WAAa,kBAGlBjC,SACGC,cAAc,uBACdU,aAAa,QAAS,cAGzBX,SACGC,cAAc,6BACdU,aAAa,QAAS,4BACpB,GAAa,cAATqB,EAAEjB,GAEXM,KAAKY,WAAa,YAGlBjC,SACGC,cAAc,6BACdU,aAAa,QAAS,cAGzBX,SACGC,cAAc,uBACdU,aAAa,QAAS,2BACpB,CACL,IAAIuB,EAAQF,EAAEjB,GAGdf,SAASC,cACP,IAAIoB,KAAKY,gCACTxB,MAAM0B,gBAAkBD,EAGF,oBAApBb,KAAKY,YACPZ,KAAKc,gBAAkBC,SAASF,GAEhClC,SAASC,cAAc,QAAQQ,MAAM0B,gBAAkBD,GAC1B,cAApBb,KAAKY,aACdZ,KAAKgB,UAAYD,SAASF,OASlC9B,EAAKkC,iBAAiB,QAAS/B,GAC/BD,EAAmBgC,iBAAiB,QAAS/B,GAO7CgC,WAAa,CACTC,EAAG,EACHrB,EAAG,GAEPd,EAAKiC,iBAAiB,cAAc9B,IAE5BA,EAAET,QAAU0C,GAAQjC,EAAEkC,iBAC1B,IAAIC,EAAQnC,EAAEoC,eAAe,GAE7BL,WAAWC,EAAIG,EAAME,QACrBN,WAAWpB,EAAIwB,EAAMG,QAErB,IAAIC,EAAW,IAAIC,WAAW,YAAa,CACzCH,QAASF,EAAME,QACfC,QAASH,EAAMG,QACfG,OAAQ,EACRC,SAAS,IAEXP,EAAM5C,OAAOoD,cAAcJ,KAC5B,CAACK,SAAS,IACb/C,EAAKiC,iBAAiB,aAAa9B,IAC7BA,EAAET,QAAU0C,GAAQjC,EAAEkC,iBAC1B,IAAIC,EAAQnC,EAAEoC,eAAe,GAEzBG,EAAW,IAAIC,WAAW,YAAa,CACzCH,QAASF,EAAME,QACfC,QAASH,EAAMG,QACfG,OAAQ,EACRC,SAAS,IAEXP,EAAM5C,OAAOoD,cAAcJ,KAC3B,CAACK,SAAS,IACZ/C,EAAKiC,iBAAiB,YAAY9B,IAC5BA,EAAET,QAAU0C,GAAQjC,EAAEkC,iBAC1B,IAAIC,EAAQnC,EAAEoC,eAAe,GAEzBG,EAAW,IAAIC,WAAW,UAAW,CACvCH,QAASF,EAAME,QACfC,QAASH,EAAMG,QACfG,OAAQ,EACRC,SAAS,IAEXP,EAAM5C,OAAOoD,cAAcJ,KAa3B,CAACK,SAAS,IAyBMpD,SAASC,cAAc,gBAC7BqC,iBAAiB,SAvB7B,SAAkB9B,GAChB,IAAI0B,EAAQ1B,EAAET,OAAOsD,MACG,oBAApBhC,KAAKY,YACPZ,KAAKc,gBAAkB,IAAImB,MACzBpB,EAAMqB,MAAM,EAAG,GACfrB,EAAMqB,MAAM,EAAG,GACfrB,EAAMqB,MAAM,EAAG,GACdC,KAAM,GAETxD,SAASC,cAAc,QAAQQ,MAAM0B,gBAAkBD,GAC1B,cAApBb,KAAKY,aACdZ,KAAKgB,UAAY,IAAIiB,MACnBpB,EAAMqB,MAAM,EAAG,GACfrB,EAAMqB,MAAM,EAAG,GACfrB,EAAMqB,MAAM,EAAG,GACdC,KAAM,IAGXxD,SAASC,cACP,IAAIoB,KAAKY,gCACTxB,MAAM0B,gBAAkBD,KASZlC,SAASC,cAAc,WAC7BqC,iBAAiB,SAJ3B,SAAiB9B,GACba,KAAKoC,QAAUjD,EAAET,OAAOsD,MAAQ,OAapCrD,SAASC,cAAc,eAAeqC,iBAAiB,UAPvD,SAAmB9B,GACXA,EAAET,OAAO2D,QACTrC,KAAKsC,SAAW,IAEhBtC,KAAKsC,SAAWC,SAASD,YAMjC,MAAMlB,EAASzC,SAASC,cAAc,UACtCwC,EAAOH,iBAAiB,cAAc,WACjB,SAAfjB,KAAKZ,MACPT,SAASC,cAAc,QAAQQ,MAAMoD,OAAS,WAE9C7D,SAASC,cAAc,QAAQQ,MAAMoD,OAAS,eAGlDpB,EAAOH,iBAAiB,cAAc,WACpCtC,SAASC,cAAc,QAAQQ,MAAMoD,OAAS,UAGlD,MAAMC,OAAS9D,SAASC,cAAc,UAChC8D,IAAMD,OAAOE,WAAW,MAE9B,IAAKD,IACH,KAAM,GAGR,IAAIE,MAASH,OAAOG,MAAQtG,OAAOuG,WAC/BC,OAAUL,OAAOK,OAASxG,OAAOyG,YAAc,GAQnD,SAAShD,mBAEP6C,MAAQH,OAAOG,MAAQtG,OAAOuG,WAC9BC,OAASL,OAAOK,OAASxG,OAAOyG,YAAc,GAC9CL,IAAIM,aAAa,EAAG,EAAG,GAAG,EAAIJ,MAAQ,EAAI,GAAIE,OAAS,GAEvDG,WAAWC,mBAGX,IAAK,IAAIC,EAAI,EAAGA,EAAIC,QAAQC,SAASC,OAAQH,IAC3C1C,EAAI2C,QAAQC,SAASF,GACrBI,IAAM9C,EAAEgC,OAERc,IAAIX,MAAQA,MACZW,IAAIT,OAASA,OAEbrC,EAAEuC,aAAa,EAAG,EAAG,GAAG,EAAIJ,MAAQ,EAAI,GAAIE,OAAS,GAErDU,MAAM/C,GAIR2C,QAAQK,aA7BNpH,WAEA2D,KAAK0D,eAAiB,KAG1BhB,IAAIM,aAAa,EAAG,EAAG,GAAG,EAAIJ,MAAM,EAAI,GAAIE,OAAO,GA2BnDxG,OAAO2E,iBAAiB,SAAUlB,kBAGlC,IAAIoB,EAAI,EACJrB,EAAI,EACJ6D,WAAY,EACZC,MAAQ,CACVzC,EAAG,EACHrB,EAAG,GAED+D,iBAAkB,EAElBZ,WAAa,CAEfa,IAAKhB,OAAS,EACdiB,MAAOnB,MAAQ,EACfoB,QAASlB,OAAS,EAClBmB,MAAOrB,MAAQ,EACfM,iBAAkB,WAChBD,WAAWa,IAAMhB,OAAS,EAC1BG,WAAWc,MAAQnB,MAAQA,MAAQ,EACnCK,WAAWe,SAAWlB,OAASA,OAAS,GACxCG,WAAWgB,MAAQrB,MAAQ,IAI/B,SAASsB,YAAYC,EAAOC,EAAKhF,EAAO4B,EAAWf,EAAWC,EAAWkC,GAIvEgB,QAAQiB,KAAKF,EAAOC,EAAKhF,EAAO4B,EAAWf,EAAWC,EAAWkC,GAWjEkC,QAAQC,SAASF,MARjB,SAASG,IAMP,OALApB,QAAQqB,IAAIrF,GACZ,WAEE,OADAgE,QAAQiB,KAAKF,EAAOC,EAAKhF,EAAO4B,EAAWf,EAAWC,EAAWkC,GAC1DoC,MAOXF,QAAQI,WAAa,GAEvB,SAASC,eAAexF,GACtB,IAAkB,IAAdwE,UACF,OAGFP,QAAQqB,IAAIzE,KAAKZ,OAOjB8E,YAJY,IAAIU,MAAMzD,EAAGrB,GACf,IAAI8E,MAAMhB,MAAMzC,EAAGyC,MAAM9D,GAMjCE,KAAKZ,MACLY,KAAKgB,UACLhB,KAAKC,UACLD,KAAKE,UACLF,KAAKoC,SAIPuB,WAAY,EAGR3D,KAAKZ,OAASxB,SACdiH,kBAAkBJ,MAClBI,kBAAkBJ,OAGxB,SAASK,iBAAiB3F,GACxB,GAAiB,IAAbA,EAAEyC,OAAc,CAElBmD,eAAgB,EAChB,IAAIZ,EAAQa,eAAe7F,GAW3B,GAVAgC,EAAIgD,EAAMhD,EACVrB,EAAIqE,EAAMrE,EACV8D,MAAMzC,EAAIA,EACVyC,MAAM9D,EAAIA,EACV6D,WAAY,EAGZP,QAAQiB,KAAKF,EAAOA,EAAOnE,KAAKZ,MAAOY,KAAKgB,UAAWhB,KAAKC,UAAWD,KAAKE,UAAWF,KAAKoC,SAGxFpC,KAAKZ,OAASxB,OAAO,CAErB,IAAI6C,EAAI,IAAI3D,OAAO,IAAImI,eAAyB,EAAVjF,KAAKkF,KAAOlF,KAAKsC,SAAU,EAAG,EAAa,EAAVtC,KAAKkF,KAAOlF,KAAKsC,SAAU6B,EAAMhD,EAAGgD,EAAMrE,EAAIE,KAAKsC,SAAWtC,KAAKkF,MAAOnE,SAASoE,OAAQ,GAClKN,kBAAkBR,KAAK5D,GAGvBoE,kBAAkBR,KAAK,IAAIzH,KAAKqI,eAAeG,wBAAwBjB,EAAOA,OAKtF,SAASkB,kBAAkBlG,GACzB,IAAImG,EAAKN,eAAe7F,GACxByE,MAAMzC,EAAImE,EAAGnE,EACbyC,MAAM9D,EAAIwF,EAAGxF,EASf,SAASkF,eAAe7F,GAEtB,OAAO,IAAIyF,MACTzF,EAAEqC,QAAUoB,MAAQ,EAAI,KACtBzD,EAAEsC,QAAUqB,OAAS,IAK3B,SAASyC,eAAepG,GAClBA,EAAEqG,aAC6B9E,IAA7Bf,aAAaC,KAAKT,EAAEsG,MACtB9F,aAAaC,KAAKT,EAAEsG,YAGa/E,IAA/Bf,aAAa+F,OAAOvG,EAAEsG,MACxB9F,aAAa+F,OAAOvG,EAAEsG,OAyB5B,SAASE,OAAOC,GACd,IAAK/B,gBAAiB,CAEpB,GAAIF,UAAW,CAEbP,QAAQqB,IAAIzE,KAAKZ,OAGjB,IAAI+E,EAAQ,IAAIS,MAAMzD,EAAGrB,GACrBsE,EAAM,IAAIQ,MAAMhB,MAAMzC,EAAGyC,MAAM9D,GACnCsD,QAAQiB,KACNF,EACAC,EACApE,KAAKZ,MACLY,KAAKgB,UACLhB,KAAKC,UACLD,KAAKE,UACLF,KAAKoC,SAGHpC,KAAKZ,OAASxB,SACdiH,kBAAkBJ,MAClBI,kBAAkBR,KAAK,IAAIzH,KAAKqI,eAAeG,wBAAwBjB,EAAOC,EAAKpE,KAAKkF,KAAMnE,SAAS8E,MAAO,EAAG7F,KAAKkF,KAAKlF,KAAKsC,UAAWvB,SAASoE,UAK1J3B,MAAMd,KAGNmC,kBAAkBiB,SAASC,GAAQA,EAAIC,KAAKtD,OAG9CpG,OAAO2J,sBAAsBN,QA/E/BlD,OAAOxB,iBAAiB,YAAa6D,kBACrCnG,SAASC,cAAc,QAAQqC,iBAAiB,UAAW0D,gBAC3DhG,SAASC,cAAc,QAAQqC,iBAAiB,YAAaoE,mBAuB7D/I,OAAO2E,iBAAiB,UAAWsE,gBAGnCrB,YACI,IAAIU,MAAM,EAAE,GACZ,IAAIA,MAAM,EAAE,KACZhI,KACAoD,KAAKgB,UACL,EACAhB,KAAKE,UACLF,KAAKoC,SAETpC,KAAKZ,MAAQxB,OACboC,KAAKgB,UAAYD,SAASmF,UAG1BrB,kBAAkBR,KAAKjB,SACvByB,kBAAkBR,KAChB,IAAIvH,OAAO,IAAImI,eAAe,GAAI,EAAG,EAAG,GAAI,GAAG,GAAK,oBAwCtDxI,iBAEI0J,aACFR,SAEES,MACFC,QAAQC,IAAI,eAAeC","sources":["main.js"],"sourcesContent":["/*\n    TODO\n    Roadmap to full release:\n        :DEV\n            - Test\n                - mobile custom color\n                - mobile filing options\n                - mobile performance\n        :PREP\n            DISTRIBUTION\n            X look into dist package on npm\n            X post to bluehost\n            - make advertisement video\n            X sitemap (html/xml)\n            X structured data\n        :RELEASE\n            MARKET\n            - post to facebook\n            - post to reddit\n                - post to \n            - post to twitter\n            - imgur\n            - tumblr\n            - youtube (video?)\n            - pinterest\n            - instagram\n            - tumblr\n            - flickr\n            - Digg\n\n        \n    - make testing suite\n        - test on Chrome/Edge/firefox/opera (safari?);\n        - test on different computers.\n            - firefox menu boxes *increase* in size, causing misplacement\n        - *new* button still doesn't work\n    -test on mobile devices\n        -scrolling issues\n        -highlighting issues\n    -SEO\n    -include structured data\n    -do sitemap \n    -add google adsense\n    -read up on marketing (google search)\n    -market product (reddit, facebook, twitter)\n    -depth first to a depth of 4-5 ? Makes it easier to draw.\n\n    MOBILE ISSUES\n    -custom color doesn't work on mobile\n    -scrolling / input on menu should be seperate.\n    -    \n    EXPANSION\n    - grab / zoom tools.\n    - snap to angle\n    - tool for more general transformation (particularly reflections, (non linear?))\n    KNOWN BUGS  \n    - lags when adding too many normal objects. Maybe try adding canvases as batches\n    - when outside elements are highlighted, user input is wonky \n        - unfixable with current knowledge (how do I know when elements are highlighted?)\n    - when a branch element is the first to be added, fade is not applied to it \n        X Couldn't replicate\n\n    ANALYSIS\n    had my mom take the program through a test drive. I got a lot of good information out of it, I'll relate the most relevant information here:\n        - For the first minute, she had no idea what to do or what the program does. [Start with fractal displayed to motivate learning?]\n        - Wanted curves in addition to straight lines\n        - gasp once branches had been used (yay!)\n        - confusion at real time draw limiting. [It might be necessary to change draw ordering? I want it to be a 'first on top' sort of thing, which it isn't for the fractals.]\n        - disatisfied with color limits [controlling fractal color approach after creation?]\n        - non replicatable [advanced menu with greater control?]\n        - thinks fill means autofill\n        - wants autofill\n        - Wants more images than what is provided (wants to put name in). \n        - More clear icons for 'save' and 'new'. \n        - save prompt box when clicking 'new' image.\n        - Wants oblong shapes\n        - started mindlessly drawing after 15 minutes (I can only grab people's attention for 15 minutes max)\n        - defaults to spirals. I should make translations / scales easier to do (snap to?);\n        \n        She seemed to think it was really cool, but it didn't really GRAB her attention.\n        It will be a good sign if she wants to look at it again without my prompting.\n\n        Proposed changes, sorted by difficulty:\n        X - done\n        O - not doing\n        L - later versions (perhaps paid version)\n        easy:\n            X cool fractal at program start (motivation)\n            L curves / oblongs\n            L tweaking color limiting\n                O 'clear' color (perserves color)\n                X colo fade slider on menu bar\n            X changing 'fill' to 'solid'\n            O labelling new / save icons\n            X alert to save when clicking 'new'\n            L snapping to specific angles.\n            - on top layer\n        hard:\n            - 'first on top' wrt new branches (urg)\n            - allowing multiple fractals\n            - allowing images / text, in addition to basic shapes / colors.\n            - advanced menu for repeatability, greater control\n        irrelevant? \n            - screen translation / zoom / rotation (non linear transformations too?)\n            - moving objects wrt time\n\n    Had josh use the program\n        -change the draw order so that new input is added immediately. He assumed there was lag, which is not what I want.\n        -He didn't immediately realize how to clear the initial fractal\n            -update 'new' button to totally undo, instead of refresh?\n            - \n*/\nlet isMobile = window.matchMedia(\"only screen and (max-width: 916px)\").matches; // I can't figure out how to deduce performance, so I'm just estimating based on screen size.\n// Container function for initializing interactive buttons in the web page.\nfunction initializeMenu() {\n  var styleMap = {\n    line: Line,\n    circle: Circle,\n    triangle: Triangle,\n    rectangle: Rectangle,\n    hexagon: Hexagon,\n    octagon: Octagon,\n    fourstar: FourStar,\n    fivestar: FiveStar,\n    branch: Branch,\n    grab: \"grab\",\n  };\n  var numberMap = {\n    one: 1,\n    two: 2,\n    three: 3,\n    four: 4,\n    five: 5,\n    six: 6,\n    seven: 7,\n    eight: 8,\n    nine: 9,\n    ten: 10,\n  };\n  var last = {\n    target: document.querySelector('#branch'),\n    class: \"branchContainer\",\n  };\n  var thicknessInputMenu_isOpen = false;\n  let menu = document.querySelector(\"#menu\");\n  let body = document.querySelector('body');\n  let thicknessInputMenu = document.querySelector(\"#thicknessInputMenu\"); //\n\n  //create event handler\n  function handler(e) {\n    // find target of hit\n    let target = e.target;\n    // if thicknessSelectBoolean is true, then the thicknessOptionPanel is open, and needs to be closed.\n    if (thicknessInputMenu_isOpen) {\n      document.querySelector(\"#thicknessInputMenu\").style.display = \"none\";\n      document\n        .querySelector(\"#thicknessDisplay\")\n        .setAttribute(\"class\", \"thicknessContainer\");\n      thicknessInputMenu_isOpen = false;\n    }\n    // control flow based on target\n    let identifier = target.getAttribute(\"class\");\n\n    if (identifier === \"menuImage\") {\n      target = target.parentNode;\n\n      // special cases:\n      if (target.id === \"undo\") {\n        actionObject.ctrl.z();\n        return;\n      } else if (target.id === \"redo\") {\n        actionObject.ctrl.y();\n        return;\n      } else if (target.id === \"center\") {\n        resetCoordinates();\n        return;\n      } else if (target.id === \"thicknessDisplay\") {\n        document\n          .querySelector(\"#thicknessDisplay\")\n          .setAttribute(\"class\", \"thicknessContainer selected\");\n\n        // display thicknessInputMenu\n        let thicknessInputMenu = document.querySelector(\"#thicknessInputMenu\");\n        thicknessInputMenu.style.display = \"block\";\n\n        //set thicknessSelectBoolean to true\n        thicknessInputMenu_isOpen = true;\n\n        return;\n      } else if (target.getAttribute(\"class\") === \"thicknessOption\") {\n        //set thickness\n        meta.thickness = numberMap[target.id];\n        return;\n      } else if (target.id === \"stroke\") {\n        meta.fillStyle = \"stroke\";\n\n        document\n          .querySelector(\"#stroke\")\n          .setAttribute(\"class\", \"menuItem selected\");\n        document.querySelector(\"#fill\").setAttribute(\"class\", \"menuItem\");\n      } else if (target.id === \"fill\") {\n        meta.fillStyle = \"fill\";\n\n        document.querySelector(\"#stroke\").setAttribute(\"class\", \"menuItem\");\n        document\n          .querySelector(\"#fill\")\n          .setAttribute(\"class\", \"menuItem selected\");\n      } else if (target.id === \"save\") {\n        save();\n      } else if (target.id === \"new\") {\n        //confirm\n        let b = confirm(\"Do you want to save changes to this image?\");\n        if (b) {\n          save();\n        }\n        setTimeout(() => window.location.replace(window.location.href), 1000);\n\n      } else {\n        // general cases:\n        meta.style = styleMap[target.id];\n\n        // add the selected target to the 'selected' class\n        let c = target.getAttribute(\"class\");\n        target.setAttribute(\"class\", c + \" selected\");\n\n        //clear the last target\n        if (last.target === undefined) {\n          last.target = target;\n          last.class = c;\n        } else {\n          last.target.setAttribute(\"class\", last.class);\n          if (last.target === target) {\n            last.target = undefined;\n            last.class = undefined;\n            meta.style = Line;\n          } else {\n            last.target = target;\n            last.class = c;\n          }\n        }\n      }\n    } else if (identifier === \"colorBoxInterior\") {\n      let p = target.parentNode;\n\n      // background color:\n      if (p.id === \"backgroundColor\") {\n        // change meta.drawStyle\n        meta.colorStyle = \"backgroundColor\";\n\n        //stop highlighting drawColor box\n        document\n          .querySelector(\"#drawColorContainer\")\n          .setAttribute(\"class\", \"colorStyle\");\n\n        //start highlighting backgroundColor\n        document\n          .querySelector(\"#backgroundColorContainer\")\n          .setAttribute(\"class\", \"colorStyle selected\");\n      } else if (p.id === \"drawColor\") {\n        //change meta.drawStyle\n        meta.colorStyle = \"drawColor\";\n\n        //stop highlighting backgroundColor box;\n        document\n          .querySelector(\"#backgroundColorContainer\")\n          .setAttribute(\"class\", \"colorStyle\");\n\n        //start highlighting drawColor box\n        document\n          .querySelector(\"#drawColorContainer\")\n          .setAttribute(\"class\", \"colorStyle selected\");\n      } else {\n        let color = p.id;\n\n        // change the background of 'Chosen color'\n        document.querySelector(\n          `#${meta.colorStyle} .colorBoxInterior`\n        ).style.backgroundColor = color;\n\n        // change meta color information.\n        if (meta.colorStyle === \"backgroundColor\") {\n          meta.backgroundColor = colorMap[color];\n          // change main background color.\n          document.querySelector(\"main\").style.backgroundColor = color;\n        } else if (meta.colorStyle === \"drawColor\") {\n          meta.drawColor = colorMap[color];\n        }\n      }\n    } else {\n      return;\n    }\n  }\n\n  //attatch handler to menu.\n  menu.addEventListener(\"click\", handler);\n  thicknessInputMenu.addEventListener(\"click\", handler);\n\n  // send touch events to document\n  // touchstart = mousedown\n  // touchmove  = mousemove\n  // touchend   = mouseup\n  // touchstart + low movement + touchend = click\n  touchStart = {\n      x: 0,\n      y: 0\n  }\n  body.addEventListener('touchstart', e => {\n      \n      if (e.target == canvas){e.preventDefault();}\n      let touch = e.changedTouches[0];\n\n      touchStart.x = touch.clientX;\n      touchStart.y = touch.clientY;\n\n      let newEvent = new MouseEvent('mousedown', {\n        clientX: touch.clientX,\n        clientY: touch.clientY,\n        button: 0,\n        bubbles: true\n      }) \n      touch.target.dispatchEvent(newEvent);\n  }, {passive: false});\n  body.addEventListener('touchmove', e =>{\n    if (e.target == canvas){e.preventDefault();}\n    let touch = e.changedTouches[0];\n\n    let newEvent = new MouseEvent('mousemove', {\n      clientX: touch.clientX,\n      clientY: touch.clientY,\n      button: 0,\n      bubbles: true\n    })\n    touch.target.dispatchEvent(newEvent);    \n  },{passive: false})\n  body.addEventListener('touchend', e =>{\n    if (e.target == canvas){e.preventDefault();}\n    let touch = e.changedTouches[0];\n\n    let newEvent = new MouseEvent('mouseup', {\n      clientX: touch.clientX,\n      clientY: touch.clientY,\n      button: 0,\n      bubbles: true\n    })\n    touch.target.dispatchEvent(newEvent);\n    \n    /*\n    if (((touchStart.x - touch.clientX) ** 2 + (touchStart.y - touch.clientY) **2) ** (0.5) < 4){\n        // click event has occured.\n        newEvent = new MouseEvent('click', {\n            clientX: touch.clientX,\n            clientY: mouse.clientY,\n            button: 0,\n            bubbles: true\n        })\n        touch.target.dispatchEvent(newEvent)\n    }*/\n  },{passive: false})  \n\n  // color form handler\n  function setColor(e) {\n    let color = e.target.value;\n    if (meta.colorStyle === \"backgroundColor\") {\n      meta.backgroundColor = new Color(\n        color.slice(1, 3),\n        color.slice(3, 5),\n        color.slice(5, 7),\n        (hex = true)\n      );\n      document.querySelector(\"main\").style.backgroundColor = color;\n    } else if (meta.colorStyle === \"drawColor\") {\n      meta.drawColor = new Color(\n        color.slice(1, 3),\n        color.slice(3, 5),\n        color.slice(5, 7),\n        (hex = true)\n      );\n    }\n    document.querySelector(\n      `#${meta.colorStyle} .colorBoxInterior`\n    ).style.backgroundColor = color;\n  }\n  let customColor = document.querySelector(\"#customColor\");\n  customColor.addEventListener(\"input\", setColor);\n\n  //fade value handler\n  function setFade(e) {\n      meta.fadeVal = e.target.value / 100;\n  }\n  let fadeRange = document.querySelector('#fading');\n  fadeRange.addEventListener(\"input\", setFade);\n\n  //turbo mode handler\n  function turboMode(e) {\n      if (e.target.checked){\n          meta.maxScale = 0.95;\n      } else {\n          meta.maxScale = metaCopy.maxScale;\n      }\n  }\n  document.querySelector('#turbo-mode').addEventListener('change', turboMode);\n\n  //canvas cursor handler.\n  const canvas = document.querySelector(\"canvas\");\n  canvas.addEventListener(\"mouseenter\", function () {\n    if (meta.style === \"grab\") {\n      document.querySelector(\"main\").style.cursor = \"grabbing\";\n    } else {\n      document.querySelector(\"main\").style.cursor = \"crosshair\";\n    }\n  });\n  canvas.addEventListener(\"mouseleave\", function () {\n    document.querySelector(\"main\").style.cursor = \"auto\";\n  });\n}\nconst canvas = document.querySelector(\"canvas\");\nconst ctx = canvas.getContext(\"2d\");\n\nif (!ctx) {\n  throw \"\";\n}\n\nvar width = (canvas.width = window.innerWidth);\nvar height = (canvas.height = window.innerHeight - 36);\nif (isMobile){\n    //reduce processor burden\n    meta.operationLimit = 1000;\n}\n\nctx.setTransform(1, 0, 0, -1, width/2 + 71, height/2);\n\nfunction resetCoordinates() {\n  // reset base canvas.\n  width = canvas.width = window.innerWidth;\n  height = canvas.height = window.innerHeight - 36;\n  ctx.setTransform(1, 0, 0, -1, width / 2 + 71, height / 2);\n\n  boundaries.updateBoundaries();\n\n  //resize and clear all canvases.\n  for (let i = 0; i < fractal.contexts.length; i++) {\n    c = fractal.contexts[i];\n    can = c.canvas;\n    //set width,height\n    can.width = width;\n    can.height = height;\n    //set transform\n    c.setTransform(1, 0, 0, -1, width / 2 + 71, height / 2);\n    //clear\n    clear(c);\n  }\n\n  //reset fractal\n  fractal.resetState();\n}\n// updates dimensions of canvas on window resize.\nwindow.addEventListener(\"resize\", resetCoordinates);\n\n// Real-time state variables\nlet x = 0;\nlet y = 0;\nlet mousedown = false;\nlet mouse = {\n  x: 0,\n  y: 0,\n};\nlet renderInterrupt = false;\n\nlet boundaries = {\n  //used when determining if a drawn object is out of frame\n  top: height / 2,\n  right: width / 2,\n  bottom: -height / 2,\n  left: -width / 2,\n  updateBoundaries: function () {\n    boundaries.top = height / 2;\n    boundaries.right = width - width / 2;\n    boundaries.bottom = -(height - height / 2);\n    boundaries.left = -width / 2;\n  },\n};\n\nfunction pushFractal(start, end, style, drawColor, thickness, fillStyle, fadeVal) {\n  // convenience function. Basically the same as fractal.push, but also populates the actions.undoList\n\n  //push object onto fractal\n  fractal.push(start, end, style, drawColor, thickness, fillStyle, fadeVal);\n\n  // update action list.\n  function undo() {\n    fractal.pop(style);\n    function unundo() {\n      fractal.push(start, end, style, drawColor, thickness, fillStyle, fadeVal);\n      return undo;\n    }\n    return unundo;\n  }\n  actions.undoList.push(undo);\n\n  // reset unundo list, since a new object has been added.\n  actions.unundoList = [];\n}\nfunction mouseupHandler(e) {\n  if (mousedown === false) {\n    return;\n  }\n  // remove the 'moving' object from the fractal\n  fractal.pop(meta.style);\n\n  // create local copies of relevant variables (undo/redo actions rely on a functional programming paradigm, so I need copies saved to local function state.)\n  let start = new Point(x, y);\n  let end = new Point(mouse.x, mouse.y);\n\n  // add to the fractal\n  pushFractal(\n    start,\n    end,\n    meta.style,\n    meta.drawColor,\n    meta.thickness,\n    meta.fillStyle,\n    meta.fadeVal\n  );\n\n  // update state\n  mousedown = false;\n\n  //remove branch indicators\n  if (meta.style == Branch){\n      objectRenderArray.pop();\n      objectRenderArray.pop();\n  }\n}\nfunction mousedownHandler(e) {\n  if (e.button === 0) {\n    // update program state\n    recentlySaved = false;\n    let start = windowToCanvas(e);\n    x = start.x;\n    y = start.y;\n    mouse.x = x;\n    mouse.y = y;\n    mousedown = true;\n\n    // add to fractal.\n    fractal.push(start, start, meta.style, meta.drawColor, meta.thickness, meta.fillStyle, meta.fadeVal);\n\n    // add scale/rotation indicators to base canvas\n    if (meta.style == Branch){\n        // add circle to canvas\n        let c = new Circle(new Transformation(meta.unit*2*meta.maxScale, 0, 0, meta.unit*2*meta.maxScale, start.x, start.y - meta.maxScale * meta.unit), colorMap.orange, 1);\n        objectRenderArray.push(c);\n\n        // add new line to canvas\n        objectRenderArray.push(new Line(Transformation.generateTransformation3(start, start)));\n    }\n  }\n}\n\nfunction updateMouseCoords(e) {\n  let pt = windowToCanvas(e);\n  mouse.x = pt.x;\n  mouse.y = pt.y;\n}\n// handlers for touch screens - Basically just passes onto the mouse handles, since they already do all the work.\n\ncanvas.addEventListener(\"mousedown\", mousedownHandler);\ndocument.querySelector('body').addEventListener(\"mouseup\", mouseupHandler);\ndocument.querySelector('body').addEventListener(\"mousemove\", updateMouseCoords);\n\n// Coordinate transformation from current window to wider system\nfunction windowToCanvas(e) {\n  // inverse of canvas to window.\n  return new Point(\n    e.clientX - width / 2 - 71,\n    -(e.clientY - height / 2)\n  );\n}\n\n// keyboard handlers\nfunction keydownHandler(e) {\n  if (e.ctrlKey) {\n    if (actionObject.ctrl[e.key] !== undefined) {\n      actionObject.ctrl[e.key]();\n    }\n  } else {\n    if (actionObject.noctrl[e.key] !== undefined) {\n      actionObject.noctrl[e.key]();\n    }\n  }\n}\nwindow.addEventListener(\"keydown\", keydownHandler);\n\n//Draw a nice initial fractal.\npushFractal(\n    new Point(0,0),\n    new Point(0,100),\n    Line,\n    meta.drawColor,\n    2,\n    meta.fillStyle,\n    meta.fadeVal\n)\nmeta.style = Branch\nmeta.drawColor = colorMap.lawngreen;\n\n//Object renderer\nobjectRenderArray.push(fractal);\nobjectRenderArray.push(\n  new Circle(new Transformation(10, 0, 0, 10, 0, -5), \"rgb(255,127,39)\")\n);\n\nfunction render(timestamp) {\n  if (!renderInterrupt) {\n    //update state variables\n    if (mousedown) {\n      // remove the last fractal element\n      fractal.pop(meta.style);\n\n      // add a new element\n      let start = new Point(x, y);\n      let end = new Point(mouse.x, mouse.y);\n      fractal.push(\n        start,\n        end,\n        meta.style,\n        meta.drawColor,\n        meta.thickness,\n        meta.fillStyle,\n        meta.fadeVal\n      );\n\n      if (meta.style == Branch){\n          objectRenderArray.pop();\n          objectRenderArray.push(new Line(Transformation.generateTransformation3(start, end, meta.unit, colorMap.black, 0, meta.unit*meta.maxScale), colorMap.orange));\n      }\n    }\n\n    //clear\n    clear(ctx);\n\n    //draw\n    objectRenderArray.forEach((obj) => obj.draw(ctx));\n  }\n  //loop\n  window.requestAnimationFrame(render);\n}\n\n// Final initialization.\ninitializeMenu();\n\nif (startRender) {\n  render();\n}\nif (test) {\n  console.log(`Total time: ${fractalDrawBenchmark()}`);\n}\n"],"names":["isMobile","window","matchMedia","matches","initializeMenu","styleMap","line","Line","circle","Circle","triangle","Triangle","rectangle","Rectangle","hexagon","Hexagon","octagon","Octagon","fourstar","FourStar","fivestar","FiveStar","branch","Branch","grab","numberMap","one","two","three","four","five","six","seven","eight","nine","ten","last","target","document","querySelector","class","thicknessInputMenu_isOpen","menu","body","thicknessInputMenu1","handler","e","style","display","setAttribute","identifier","getAttribute","parentNode","id","actionObject","ctrl","z","y","resetCoordinates","meta","thickness","fillStyle","save","confirm","setTimeout","location","replace","href","c","undefined","p","colorStyle","color","backgroundColor","colorMap","drawColor","addEventListener","touchStart","x","canvas1","preventDefault","touch","changedTouches","clientX","clientY","newEvent","MouseEvent","button","bubbles","dispatchEvent","passive","value","Color","slice","hex","fadeVal","checked","maxScale","metaCopy","cursor","canvas","ctx","getContext","width","innerWidth","height","innerHeight","setTransform","boundaries","updateBoundaries","i","fractal","contexts","length","can","clear","resetState","operationLimit","mousedown","mouse","renderInterrupt","top","right","bottom","left","pushFractal","start","end","push","actions","undoList","undo","pop","unundoList","mouseupHandler","Point","objectRenderArray","mousedownHandler","recentlySaved","windowToCanvas","Transformation","unit","orange","generateTransformation3","updateMouseCoords","pt","keydownHandler","ctrlKey","key","noctrl","render","timestamp","black","forEach","obj","draw","requestAnimationFrame","lawngreen","startRender","test","console","log","fractalDrawBenchmark"],"version":3,"file":"index.b74a5583.js.map"}